;controllo definizione di input
(defrule controlla_input
	(declare (salience 9000))
	?indice <- (inizia (config_iniziale ?conf_iniz))
	(stato ?conf_iniz)
	?ind <- (config inesatta)
=>
	(retract ?indice ?ind)
	(assert (config esatta))
	(if (eq ?conf_iniz ACPL)
		then (assert (configurazione))
		else (if (eq ?conf_iniz ____) then
			(assert (configurazione(agricoltore "sulla-riva-lontana")
				(cavolo "sulla-riva-lontana")
				(pecora "sulla-riva-lontana")
				(lupo "sulla-riva-lontana"))))
		else (if (eq ?conf_iniz A_P_) then
			(assert (configurazione(agricoltore "sulla-riva-vicina")
				(cavolo "sulla-riva-lontana")
				(pecora "sulla-riva-vicina")
				(lupo "sulla-riva-lontana"))))
		else (if (eq ?conf_iniz _C_L) then
			(assert (configurazione(agricoltore "sulla-riva-lontana")
				(cavolo "sulla-riva-vicina")
				(pecora "sulla-riva-lontana")
				(lupo "sulla-riva-vicina"))))
		else (if (eq ?conf_iniz A_PL) then
			(assert (configurazione(agricoltore "sulla-riva-vicina")
				(cavolo "sulla-riva-lontana")
				(pecora "sulla-riva-vicina")
				(lupo "sulla-riva-vicina"))))
		else (if (eq ?conf_iniz _C__) then
			(assert (configurazione(agricoltore "sulla-riva-lontana")
				(cavolo "sulla-riva-vicina")
				(pecora "sulla-riva-lontana")
				(lupo "sulla-riva-lontana"))))
		else (if (eq ?conf_iniz AC_L) then
			(assert (configurazione(agricoltore "sulla-riva-vicina")
				(cavolo "sulla-riva-vicina")
				(pecora "sulla-riva-lontana")
				(lupo "sulla-riva-vicina"))))
		else (if (eq ?conf_iniz ___L) then
			(assert (configurazione(agricoltore "sulla-riva-lontana")
				(cavolo "sulla-riva-lontana")
				(pecora "sulla-riva-lontana")
				(lupo "sulla-riva-vicina"))))
		else (if (eq ?conf_iniz ACP_) then
			(assert (configurazione(agricoltore "sulla-riva-vicina")
				(cavolo "sulla-riva-vicina")
				(pecora "sulla-riva-vicina")
				(lupo "sulla-riva-lontana"))))
		else (if (eq ?conf_iniz __P_) then
			(assert (configurazione(agricoltore "sulla-riva-lontana")
				(cavolo "sulla-riva-lontana")
				(pecora "sulla-riva-vicina")
				(lupo "sulla-riva-lontana"))))
		)
(printout t "Le mosse dell'agricoltore sono: " crlf crlf))



(defrule ritenta "Se la configurazione data in input e' errata"
  (declare (salience 8500))
  ?indice <- (config inesatta)	
 =>
  (retract ?indice)
  (printout t crlf "La configurazione iniziale data 
					in input risulta illegale!!!" crlf crlf crlf)
  (printout t "Vuoi riprovare? (S/N): ")
  (bind ?risposta (read))
  (if (eq ?risposta S) then (reset) 
	else (printout t crlf crlf"**************" crlf crlf)))


(defrule continua_gioco "L'utente vuole giocare ancora?"
  (declare (salience -10000))
  ?indice <- (config esatta)
 =>
  (retract ?indice)
  (printout t crlf crlf crlf "Vuoi giocare ancora? (S/N): ")
  (bind ?risposta(read))
  (if (eq ?risposta S) then (reset)
  	else (printout t crlf "******************" crlf crlf)))



(deffacts stati_legali  "Stati validi nel gioco"
	(stato  ACPL)  
	(stato  ____) 
	(stato  A_P_) 
	(stato  _C_L) 
	(stato  A_PL) 
	(stato  _C__)
	(stato  AC_L)
	(stato  ___L)
	(stato  ACP_)
	(stato  __P_))

 
